!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(n.MDJ=n.MDJ||{})}(this,function(n){"use strict";var r=function(){var n=arguments[0],r=n.length,e=function(){var t=Array.prototype.slice.call(arguments);return t.length>=r?n.apply(null,t):e.bind.apply(e,[null].concat(t))};return e.bind.apply(e,[null].concat(Array.prototype.slice.call(arguments,1)))},e=function(n){return n.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n").replace(/^ +$/gm,"")},t=function(){var n=Array.prototype.slice.call(arguments),r=n.length-1;return function(e){for(var t=e,u=r;u>=0;u-=1)t=n[u](t);return t}},u=(r(function(n,r){return n===r}),r(function(n,r){return n.exec(r)})),i=r(function(n,r){for(var e=new Array(r.length),t=0;t<r.length;t+=1)e[t]=n(r[t],t,r);return e}),l=r(function(n,r){return r.match(n)||[]}),o=r(function(n,r){return n.test(r)}),a=r(function(n,r,e){return e.replace(n,r)}),s=r(function(n,r){return r.split(n)}),c=(r(function(n,r){return 0===r.indexOf(n)}),function(n){return n.trim()}),f=u(/^( *>[^\n]+(\n(?! *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$))[^\n]+)*\n*)+/),p=a(/^ *> ?/gm,""),g=function(n,r){if(">"!==n[0])return null;var e=f(n);if(!e)return null;var t=e[0],u=r(p(t));return 1===u.length&&"paragraph"===u[0].type&&(u=u[0].children),{token:{type:"blockquote",children:r(p(t))},newSource:n.substring(t.length)}},b=u(/^( {4}[^\n]+\n*)+/),h=a(/^ {4}/gm,""),v=u(/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/),d=function(n){if("`"!==n[0])return null;var r=b(n);if(!r)return null;var e=r[0];return{token:{type:"codeblock",language:"",value:h(e)},newSource:n.substring(e.length)}},y=function(n){var r=v(n);if(!r)return null;var e=r[0];return{token:{type:"codeblock",language:r[2],value:r[3]},newSource:n.substring(e.length)}},k=function(n){return d(n)||y(n)},S=u(/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/),m=u(/^([^\n]+)\n *([=-]){2,} *(?:\n+|$)/),w=function(n){return"#"===n[0]?n.length:"="===n[0]?1:2},$=function(n,r,e){var t="#"===n[0],u=t&&S(n)||m(n);if(!u)return null;var i=u[0],l=t?u[1]:u[2],o=t?u[2]:u[1];return{token:{type:"heading",level:w(l),children:e(o)},newSource:n.substring(i.length)}},_=u(/^ *(?:\*{3,}|-{3,}|_{3,}) *(?:\n+|$)/),x=function(n){var r=_(n);if(!r)return null;var e=r[0];return{token:{type:"hr"},newSource:n.substring(e.length)}},A=u(/^(?:<!--[\s\S]*?--> *(?:\n|\s*$)|<((?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\b)\w+(?!:\/|[^\w\s@]*@)\b)[\s\S]+?<\/\1> *(?:\n{2,}|\s*$)|<(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\b)\w+(?!:\/|[^\w\s@]*@)\b(?:"[^"]*"|'[^']*'|[^'">])*?> *(?:\n{2,}|\s*$))/),q=function(n){if("<"!==n[0])return null;var r=A(n);if(!r)return null;var e=r[0];return{token:{type:"html",value:e},newSource:n.substring(e.length)}},j=u(/^( *)((?:[*+-]|\d+\.)) [\s\S]+?(?:\n+(?=\1?(?:[-*_] *){3,}(?:\n+|$))|\n+(?= *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$))|\n{2,}(?! )(?!\1(?:[*+-]|\d+\.) )\n*|\s*$)/),M=l(/^( *)((?:[*+-]|\d+\.)) [^\n]*(?:\n(?!\1(?:[*+-]|\d+\.) )[^\n]*)*/gm),O=a(/^ *([*+-]|\d+\.) +/,""),P=a(/^ */gm,""),D=l(/^(\d)/),I=a(/\n(?=\d*\. )/,"\n\n"),J=function(n,r){var e=j(n);if(!e)return null;var u=e[0],i=e[2],l=t(r,I,P,O),o=M(u).map(function(n){var r=l(n);return 1===r.length&&"paragraph"===r[0].type&&(r=r[0].children),{type:"listitem",children:r}}),a=D(i);return{token:{type:"list",ordered:!!a,start:a&&+a[1],children:o},newSource:n.substring(u.length)}},B=u(/^\n+/),C=function(n){var r=B(n);if(!r)return null;var e=r[0];return{token:{type:"space"},newSource:n.substring(e.length)}},E=u(/^((?:[^\n]+\n?)+)\n*/),z=a(/\n$/," "),F=function(n,r,e){var t=E(n);if(!t)return null;var u=t[0],i=t[1];return{token:{type:"paragraph",children:e(z(i))},newSource:n.substring(u.length)}},G=/ *\| */,H=a(/^ *| *\| *$/g,""),K=a(/^ *\| *| *\| *$/g,""),L=a(/^ *|\| *$/g,""),N=a(/\n$/," "),Q=a(/(?: *\| *)?\n$/,""),R=s("\n"),T=o(/^ *-+: *$/),U=o(/^ *:-+: *$/),V=function(n){for(var r=[],e=0,t=0;t<n.length;t+=1)"|"!==n[t]||"`"===n[t-1]||"\\"===n[t-1]?r[e]=(r[e]||"")+n[t]:e++;return i(c,r)},W=function(n,r){return t(i(n),V,H)(r)},X=t(V,K),Y=function(n){return T(n)?"right":U(n)?"center":"left"},Z=t(i(Y),s(G),L),nn=function(n,r){return t(i(t(i(n),X)),R,Q)(r)},rn=function(n,r){return t(i(t(i(n),s(G))),R,N)(r)},en=u(/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/),tn=u(/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/),un=function(n,r,e){var t=en(n),u=!0;if(t||(t=tn(n),u=!1),!t)return null;var i=t[0],l=t[1],o=t[2],a=t[3];return i?{token:{type:"table",header:W(e,l),align:Z(o),cells:u?rn(e,a):nn(e,a)},newSource:n.substring(i.length)}:null},ln=u(/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/),on=function(n){if("`"!==n[0])return null;var r=ln(n);if(!r)return null;var e=r[0];return{token:{type:"code",value:r[2]},newSource:n.substring(e.length)}},an=u(/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/),sn=function(n,r){if("_"!==n[0]&&"*"!==n[0])return null;var e=an(n);if(!e)return null;var t=e[0],u=e[1];return{token:{type:"em",children:r(e[2]||u)},newSource:n.substring(t.length)}},cn=u(/^\\([\\`*{}[\]()#+\-.!_>~|])/),fn=function(n){if("\\"!==n[0])return null;var r=cn(n);if(!r)return null;var e=r[0];return{token:{type:"text",value:e},newSource:n.substring(e.length)}},pn=u(/^(?:<(a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img))(?: *\S+=['"].*['"])*(?: *\/>|>.*?<\/\1>)/),gn=function(n){if("<"!==n[0])return null;var r=pn(n);if(!r)return null;var e=r[0];return{token:{type:"html",value:e},newSource:n.substring(e.length)}},bn=u(/^ *\n(?!\s*$)/),hn=function(n){var r=bn(n);if(!r)return null;var e=r[0];return{token:{type:"br"},newSource:n.substring(e.length)}},vn=u(/^<([^ >]+(@|:\/)[^ >]+)>/),dn=function(n){if("<"!==n[0])return null;var r=vn(n);if(!r)return null;var e=r[0],t=r[2],u=r[1],i="";return"@"===t?(u=":"===u.charAt(6)?u.substring(7):u,i="mailto:"+u):i=u,{token:{type:"link",href:i,children:[{type:"text",value:u}]},newSource:n.substring(e.length)}},yn=o(/^http/),kn=u(/^(https?:\/\/[^\s<]+[^<.,:;"')}\]\s])/),Sn=function(n){if(!yn(n))return null;var r=kn(n);if(!r)return null;var e=r[0],t=r[1];return{token:{type:"link",href:t,children:[{type:"text",value:t}]},newSource:n.substring(e.length)}},mn=u(/^!?\[(.*)\]\((?:([\S]*) *["'](.*)["']\)|(.*)(?: *\)))/),wn=function(n){for(var r=0,e="",t=0;t<n.length&&(")"!==n[t]||0!==r);t+=1)"("===n[t]&&r++,")"===n[t]&&r--,e+=n[t];return[e,n.substring(e.length)]},$n=function(n,r){if("["!==n[0]&&"!"!==n[0])return null;var e,t=mn(n);if(!t)return null;var u=t[0],i=t[1],l=t[2],o=t[3];if(t[4]){var a=wn(t[4]);l=a[0],u=a[1].length?u.slice(0,-a[1].length):u}return e="!"===u[0]?{type:"image",src:l,alt:i}:{type:"link",href:l,children:r(i)},o&&(e.title=o),{token:e,newSource:n.substring(u.length)}},_n=function(n,r){return dn(n)||Sn(n)||$n(n,r)},xn=u(/^~~(?=\S)([\s\S]*?\S)~~/),An=function(n,r){if("~"!==n[0])return null;var e=xn(n);if(!e)return null;var t=e[0];return{token:{type:"strikethrough",children:r(e[1])},newSource:n.substring(t.length)}},qn=u(/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/),jn=function(n,r){if("_"!==n[0]&&"*"!==n[0])return null;var e=qn(n);if(!e)return null;var t=e[0],u=e[1];return{token:{type:"strong",children:r(e[2]||u)},newSource:n.substring(t.length)}},Mn=u(/^[\s\S]+?(?=[\\<![_*`~]|https?:\/\/| *\n|$)/),On=function(n){var r=Mn(n);if(!r)return null;var e=r[0];return{token:{type:"text",value:e},newSource:n.substring(e.length)}},Pn={html:!1},Dn=function(n){function r(n,r,e){o[n].push({parser:r,priority:e}),o[n]=o[n].sort(function(n,r){return r.priority-n.priority})}function t(n,r){for(var e,t=o[n].length,u="",i=0;i<t;i+=1){var l=o[n][i].parser,c="block"===n?l(r,a,s):l(r,s);if(c){u=c.newSource,e=c.token;break}}return e?{token:e,newSource:u}:null}function u(n){return function(r){for(var e=[];r.length>0;){var u=t(n,r)||{},i=u.token,l=void 0===i?null:i,o=u.newSource,a=void 0===o?"":o;if(r===a||!l)throw new Error("Infinite loop on byte: "+r.charCodeAt(0));e.push(l),r=a}return e}}function i(n){return e(n)}var l=Object.assign({},Pn,n),o={block:[{parser:C,priority:1e3},{parser:$,priority:900},{parser:x,priority:800},{parser:g,priority:700},{parser:k,priority:600},{parser:un,priority:500},{parser:J,priority:400},{parser:F,priority:0}],inline:[{parser:fn,priority:1e3},{parser:on,priority:900},{parser:jn,priority:800},{parser:sn,priority:700},{parser:An,priority:600},{parser:_n,priority:500},{parser:hn,priority:400},{parser:On,priority:0}]};l.html&&(r("block",q,200),r("inline",gn,200));var a=u("block"),s=u("inline"),c={parse:function(n){return a(i(n))},useInlineParser:function(n,e){return r("inline",n,e),c},useBlockParser:function(n,e){return r("block",n,e),c}};return c},In=function(n){return Dn().parse(n)};n.default=Dn,n.parse=In,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map

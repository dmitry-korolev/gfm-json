!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(n.MDJ=n.MDJ||{})}(this,function(n){"use strict";var r=function(){var n=arguments[0],r=n.length,e=function(){var t=Array.prototype.slice.call(arguments);return t.length>=r?n.apply(null,t):e.bind.apply(e,[null].concat(t))};return e.bind.apply(e,[null].concat(Array.prototype.slice.call(arguments,1)))},e=function(n){return n.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n").replace(/^ +$/gm,"")},t=function(){var n=Array.prototype.slice.call(arguments),r=n.length-1;return function(e){for(var t=e,u=r;u>=0;u-=1)t=n[u](t);return t}},u=(r(function(n,r){return n===r}),r(function(n,r){return n.exec(r)})),i=r(function(n,r){for(var e=new Array(r.length),t=0;t<r.length;t+=1)e[t]=n(r[t],t,r);return e}),l=r(function(n,r){return r.match(n)||[]}),o=r(function(n,r){return n.test(r)}),a=r(function(n,r,e){return e.replace(n,r)}),s=r(function(n,r){return r.split(n)}),c=(r(function(n,r){return 0===r.indexOf(n)}),function(n){return n.trim()}),p=u(/^( {0,3}>[^\n]+(\n(?! *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$))[^\n]+)*\n*)+/),f=a(/^ *> ?/gm,""),g=o(/^ {0,3}>/),b=function(n,r){if(!g(n))return null;var e=p(n);if(!e)return null;var t=e[0],u=r(f(t));return 1===u.length&&"paragraph"===u[0].type&&(u=u[0].children),{token:{type:"blockquote",children:r(f(t))},newSource:n.substring(t.length)}},h=u(/^( {4}[^\n]+\n*)+/),v=a(/^ {4}/gm,""),d=u(/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/),y=function(n){var r=h(n);if(!r)return null;var e=r[0];return{token:{type:"codeblock",value:v(e)},newSource:n.substring(e.length)}},k=function(n){if("`"!==n[0]&&"~"!==n[0])return null;var r=d(n);if(!r)return null;var e=r[0],t=r[2],u=r[3],i={type:"codeblock",value:u};return t&&(i.language=t),{token:i,newSource:n.substring(e.length)}},S=function(n){return y(n)||k(n)},m=u(/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/),w=u(/^([^\n]+)\n *([=-]){2,} *(?:\n+|$)/),$=function(n){return"#"===n[0]?n.length:"="===n[0]?1:2},_=function(n,r,e){var t="#"===n[0],u=t&&m(n)||w(n);if(!u)return null;var i=u[0],l=t?u[1]:u[2],o=t?u[2]:u[1];return{token:{type:"heading",level:$(l),children:e(o)},newSource:n.substring(i.length)}},x=u(/^ *(?:\*{3,}|-{3,}|_{3,}) *(?:\n+|$)/),A=function(n){var r=x(n);if(!r)return null;var e=r[0];return{token:{type:"hr"},newSource:n.substring(e.length)}},q=u(/^(?:<!--[\s\S]*?--> *(?:\n|\s*$)|<((?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\b)\w+(?!:\/|[^\w\s@]*@)\b)[\s\S]+?<\/\1> *(?:\n{2,}|\s*$)|<(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\b)\w+(?!:\/|[^\w\s@]*@)\b(?:"[^"]*"|'[^']*'|[^'">])*?> *(?:\n{2,}|\s*$))/),j=function(n){if("<"!==n[0])return null;var r=q(n);if(!r)return null;var e=r[0];return{token:{type:"html",value:e},newSource:n.substring(e.length)}},M=u(/^( *)((?:[*+-]|\d+\.)) [\s\S]+?(?:\n+(?=\1?(?:[-*_] *){3,}(?:\n+|$))|\n+(?= *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$))|\n{2,}(?! )(?!\1(?:[*+-]|\d+\.) )\n*|\s*$)/),O=l(/^( *)((?:[*+-]|\d+\.)) [^\n]*(?:\n(?!\1(?:[*+-]|\d+\.) )[^\n]*)*/gm),P=a(/^ *([*+-]|\d+\.) +/,""),D=a(/^ */gm,""),I=l(/^(\d)/),J=a(/\n(?=\d*\. )/,"\n\n"),B=function(n,r){var e=M(n);if(!e)return null;var u=e[0],i=e[2],l=t(r,J,D,P),o=O(u).map(function(n){var r=l(n);return 1===r.length&&"paragraph"===r[0].type&&(r=r[0].children),{type:"listitem",children:r}}),a=I(i);return{token:{type:"list",ordered:!!a.length,start:a.length?+a[1]:null,children:o},newSource:n.substring(u.length)}},C=u(/^\n+/),E=function(n){var r=C(n);if(!r)return null;var e=r[0];return{token:{type:"space"},newSource:n.substring(e.length)}},z=u(/^((?:[^\n]+\n?(?! {0,3}>))+)\n*/),F=a(/\n$/," "),G=function(n,r,e){var t=z(n);if(!t)return null;var u=t[0],i=t[1];return{token:{type:"paragraph",children:e(F(i))},newSource:n.substring(u.length)}},H=a(/^ *| *\| *$/g,""),K=a(/^ *\| *| *\| *$/g,""),L=a(/^ *|\| *$/g,""),N=a(/\n$/," "),Q=a(/(?: *\| *)?\n$/,""),R=s("\n"),T=o(/^ *-+: *$/),U=o(/^ *:-+: *$/),V=function(n){for(var r=[],e=0,t=0;t<n.length;t+=1)"|"!==n[t]||"`"===n[t-1]||"\\"===n[t-1]?r[e]=(r[e]||"")+n[t]:e++;return i(c,r)},W=function(n,r){return t(i(n),V,H)(r)},X=t(V,K),Y=function(n){return T(n)?"right":U(n)?"center":"left"},Z=t(i(Y),s(/ *\| */),L),nn=function(n,r){return t(i(t(i(n),X)),R,Q)(r)},rn=function(n,r){return t(i(t(i(n),s(/ *\| */))),R,N)(r)},en=u(/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/),tn=u(/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/),un=function(n,r,e){var t=en(n),u=!0;if(t||(t=tn(n),u=!1),!t)return null;var i=t[0],l=t[1],o=t[2],a=t[3];return i?{token:{type:"table",header:W(e,l),align:Z(o),cells:u?rn(e,a):nn(e,a)},newSource:n.substring(i.length)}:null},ln=u(/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/),on=function(n){if("`"!==n[0])return null;var r=ln(n);if(!r)return null;var e=r[0];return{token:{type:"code",value:r[2]},newSource:n.substring(e.length)}},an=u(/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/),sn=function(n,r){if("_"!==n[0]&&"*"!==n[0])return null;var e=an(n);if(!e)return null;var t=e[0],u=e[1];return{token:{type:"em",children:r(e[2]||u)},newSource:n.substring(t.length)}},cn=u(/^\\([\\`*{}[\]()#+\-.!_>~|])/),pn=function(n){if("\\"!==n[0])return null;var r=cn(n);if(!r)return null;var e=r[0];return{token:{type:"text",value:e},newSource:n.substring(e.length)}},fn=u(/^(?:<(a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img))(?: *\S+=['"].*['"])*(?: *\/>|>.*?<\/\1>)/),gn=function(n){if("<"!==n[0])return null;var r=fn(n);if(!r)return null;var e=r[0];return{token:{type:"html",value:e},newSource:n.substring(e.length)}},bn=u(/^ *\n(?!\s*$)/),hn=function(n){var r=bn(n);if(!r)return null;var e=r[0];return{token:{type:"br"},newSource:n.substring(e.length)}},vn=u(/^<([^ >]+(@|:\/)[^ >]+)>/),dn=function(n){if("<"!==n[0])return null;var r=vn(n);if(!r)return null;var e=r[0],t=r[2],u=r[1],i="";return"@"===t?(u=":"===u.charAt(6)?u.substring(7):u,i="mailto:"+u):i=u,{token:{type:"link",href:i,children:[{type:"text",value:u}]},newSource:n.substring(e.length)}},yn=o(/^http/),kn=u(/^(https?:\/\/[^\s<]+[^<.,:;"')}\]\s])/),Sn=function(n){if(!yn(n))return null;var r=kn(n);if(!r)return null;var e=r[0],t=r[1];return{token:{type:"link",href:t,children:[{type:"text",value:t}]},newSource:n.substring(e.length)}},mn=u(/^!?\[((?:\[[^\]]*\]|[^[\]]|\](?=[^[]*\]))*)\]\(\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*\)/),wn=function(n,r){if("["!==n[0]&&"!"!==n[0])return null;var e,t=mn(n);if(!t)return null;var u=t[0],i=t[1],l=t[2],o=t[3];return e="!"===u[0]?{type:"image",src:l,alt:i}:{type:"link",href:l,children:r(i)},o&&(e.title=o),{token:e,newSource:n.substring(u.length)}},$n=function(n,r){return dn(n)||Sn(n)||wn(n,r)},_n=u(/^~~(?=\S)([\s\S]*?\S)~~/),xn=function(n,r){if("~"!==n[0])return null;var e=_n(n);if(!e)return null;var t=e[0];return{token:{type:"strikethrough",children:r(e[1])},newSource:n.substring(t.length)}},An=u(/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/),qn=function(n,r){if("_"!==n[0]&&"*"!==n[0])return null;var e=An(n);if(!e)return null;var t=e[0],u=e[1];return{token:{type:"strong",children:r(e[2]||u)},newSource:n.substring(t.length)}},jn=u(/^[\s\S]+?(?=[\\<![_*`~]|https?:\/\/| *\n|$)/),Mn=function(n){var r=jn(n);if(!r)return null;var e=r[0];return{token:{type:"text",value:e},newSource:n.substring(e.length)}},On={html:!1},Pn=function(n){function r(n,r,e){o[n].push({parser:r,priority:e}),o[n]=o[n].sort(function(n,r){return r.priority-n.priority})}function t(n,r){for(var e,t=o[n].length,u="",i=0;i<t;i+=1){var l=o[n][i].parser,c="block"===n?l(r,a,s):l(r,s);if(c){u=c.newSource,e=c.token;break}}return e?{token:e,newSource:u}:null}function u(n){return function(r){for(var e=[];r.length>0;){var u=t(n,r)||{},i=u.token,l=void 0===i?null:i,o=u.newSource,a=void 0===o?"":o;if(r===a||!l)throw new Error("Infinite loop on byte: "+r.charCodeAt(0));e.push(l),r=a}return e}}function i(n){return e(n)}var l=Object.assign({},On,n),o={block:[{parser:E,priority:1e3},{parser:_,priority:900},{parser:A,priority:800},{parser:b,priority:700},{parser:B,priority:600},{parser:un,priority:500},{parser:S,priority:400},{parser:G,priority:0}],inline:[{parser:pn,priority:1e3},{parser:on,priority:900},{parser:qn,priority:800},{parser:sn,priority:700},{parser:xn,priority:600},{parser:hn,priority:500},{parser:$n,priority:400},{parser:Mn,priority:0}]};l.html&&(r("block",j,200),r("inline",gn,200));var a=u("block"),s=u("inline"),c={parse:function(n){return a(i(n))},useInlineParser:function(n,e){return r("inline",n,e),c},useBlockParser:function(n,e){return r("block",n,e),c}};return c},Dn=function(n){return Pn().parse(n)};n.default=Pn,n.parse=Dn,Object.defineProperty(n,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
